updateFiles:
  -
    file: "typo3/sysext/core/Classes/Core/SystemEnvironmentBuilder.php"
    # Escaped ' is done via ''
    pattern: '\''TYPO3_version\'',\s*\''([^\'']+)'
    type: "bugfixVersion"
  -
    file: "typo3/sysext/core/Classes/Core/SystemEnvironmentBuilder.php"
    pattern: '\''TYPO3_branch\'',\s*\''([^\'']+)'
    type: "minorVersion"
  -
    file: "typo3/sysext/*/ext_emconf.php"
    pattern: '\''(?!.*?php).*\''\s=>\s\''([6-9]+\.[0-9]+\.[0-9]+\s*[\-]*\s*[6-9]*\.*[0-9]*\.*[0-9]*)'
    type: "bugfixVersion"
  -
    file: "typo3/sysext/*/composer.json"
    pattern: '"typo3\/cms-[^"]+"\s*:\s*"([6-9]+\.[0-9]+\.\*@dev)'
    type: "bugfixVersion"
  -
    file: "typo3/sysext/core/Classes/Core/SystemEnvironmentBuilder.php"
    # Escaped ' is done via ''
    pattern: '\''TYPO3_version\'',\s*\''([^\'']+)'
    type: "nextDevVersion"
  -
    file: "typo3/sysext/*/composer.json"
    pattern: '"typo3\/cms-[^"]+"\s*:\s*"([6-9]+\.[0-9]+\.[0-9]+)'
    type: "nextDevBranch"
  # ensure 8.7.5 is replaced by 8.7.6
  -
    file: "typo3/sysext/*/ext_emconf.php"
    pattern: '\''(?!.*?php).*\''\s=>\s\''([6-9]+\.[0-9]+\.[0-9]+\s*[\-]*\s*[6-9]*\.*[0-9]*\.*[0-9]*)'
    type: "nextBugfixVersion"



excludeFromPackaging:
  ".":
    - ".editorconfig"
    - ".gitignore"
    - ".gitmodules"
    - ".gitattributes"
    - ".gitreview"
    - ".stylelintrc"
    - "dynamicReturnTypeMeta.json"
    - "bin"
    - "Build"
    - "*.webprj"
    - "*.orig"
    - "*~"
    - ".travis.yml"
    - ".appveyor.yml"
  "**":
    - ".gitignore"
    - ".git/"
    - ".svn"
    - ".travis.yml"
    - ".appveyor.yml"
  "vendor/**":
    - "Test"
    - "tests"
    - "Tests"
    - "docs"
    - "examples"
    - "example.php"

executableFilesInPackage:
  - "*.phpcron"
  - "*.phpsh"
  - "*.sh"
  - "*.pl"
  - "typo3/sysext/core/bin/typo3"

announce:
  endpoints:
    getRelease:
      method: "GET"
      uri: "/v1/api/release/{version}"
    addRelease:
      method: "POST"
      uri: "/v1/api/release/"
    updateRelease:
      method: "PATCH"
      uri: "/v1/api/release/{version}"
    setReleaseNotes:
      method: "PUT"
      uri: "/v1/api/release/{version}/release-notes"
  models:
    default:
      release:
        version: "{version}"
        date: "{date}"
        type: "{type}"
        tar_package:
          md5sum: "{hash.md5.tar}"
          sha1sum: "{hash.sha1.tar}"
          sha256sum: "{hash.sha256.tar}"
        zip_package:
          md5sum: "{hash.md5.zip}"
          sha1sum: "{hash.sha1.zip}"
          sha256sum: "{hash.sha256.zip}"
      releaseNotes:
        news_link: "{notes.link}"
        news: "{notes.teaser}"
        upgrading_instructions: "{notes.instructions}"
        changes: "{notes.changes}"
    ">=9.0.0":
      release:
        version: "{version}"
        date: "{date}"
        type: "{type}"
        tar_package:
          sha1sum: "{hash.sha1.tar}"
          sha256sum: "{hash.sha256.tar}"
        zip_package:
          sha1sum: "{hash.sha1.zip}"
          sha256sum: "{hash.sha256.zip}"
